(this["webpackJsonpreact-diffuse-example"]=this["webpackJsonpreact-diffuse-example"]||[]).push([[0],{21:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);n(21);var r=n(0),c=n.n(r),i=n(17),o=n.n(i);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}var u=function(e){var t,n=Object(r.createContext)({value:{current:e},register:function(){return function(){}}});return delete n.Consumer,n.Provider=(t=n.Provider,function(e){var n=e.value,i=e.children,o=Object(r.useRef)(n),a=Object(r.useRef)(new Set),u=Object(r.useRef)({value:o,registerListener:function(e){return a.current.add(e),function(){return a.current.delete(e)}},listeners:new Set});return Object(r.useEffect)((function(){o.current=n,a.current.forEach((function(e){e(n)}))}),[n]),c.a.createElement(t,{value:u.current},i)}),n}(),s=function(e){return function(e,t){var n=Object(r.useContext)(e),c=n.value,i=n.registerListener,o=Object(r.useRef)(t),a=Object(r.useState)((function(){return t(c.current)})),u=a[0],s=a[1];return Object(r.useEffect)((function(){o.current=t})),Object(r.useEffect)((function(){return i((function(e){var t=o.current(e);s((function(){return t}))}))}),[i,c]),u}(u,(function(t){return t[e]}))},f=function(e){var t=e.fuseName,n=void 0===t?[]:t,i=e.Child;return function(e){for(var t={},o=[],u=0;u<n.length;u++){var f=s(n[u]);t[n[u]]=f,o.push(f.store)}return Object(r.useMemo)((function(){return c.a.createElement(i,a({},t,e))}),[e].concat(o))}},d=function(e){var t=e.reducer,n=e.initialState,r=e.middleware,i=e.asyncReducer,o=void 0===i?null:i,u=e.actions,s=e.asyncActions,f=c.a.useReducer((function(e,t){return t.store}),n),d=f[0],l=f[1],m=function(){return p({type:"LOADING"})},v=function(e){return p({type:"SUCCESS",payload:e})},y=function(e){return p({type:"FAIL",payload:e})},b=function(e){return p({type:"PROGRESS",payload:e})},p=function(e){try{var n=function(){return r&&r.afterWare&&r.afterWare.forEach((function(e){e(c)})),c},c=e;void 0===c.store&&(c.store=d),r&&r.beforeWare&&r.beforeWare.forEach((function(e){e(c)}));var i=function(){if(null!==o&&Object.keys(s).includes(c.type))return Promise.resolve(function(e){try{return Promise.resolve(o(e,v,y,b,m)).then((function(e){return e.store}))}catch(t){return Promise.reject(t)}}(c)).then((function(e){c=a({},c,{store:a({},e)})}));var e=a({},function(e){var n=t(e.store,e);return e.store!==n&&(e.store=n),l(e),n}(c));c=a({},c,{store:a({},e)})}();return Promise.resolve(i&&i.then?i.then(n):n())}catch(u){return Promise.reject(u)}};return{store:d,dispatch:p,actions:function(){var e=Object.keys(u),t=Object.keys(s),n={};return e.map((function(e){n[e]=function(t){return p({type:e,payload:t})}})),t.map((function(e){n[e]=function(t){return p({type:e,payload:t})}})),n}()}},l=function(e){var t=e.initialState,n=void 0===t?{}:t,r=e.actions,c=void 0===r?[]:r,i=e.middleware,o=void 0===i?{beforeWare:[],afterWare:[]}:i,u={initialState:a({diffuse:{loading:!1,error:!1}},n),actionsDict:{INITIALIZE_STORE:function(e,t){return void 0===t&&(t={}),a({diffuse:{loading:!1,error:!1}},n,t)},LOADING:function(e){return{diffuse:{loading:!0,error:!1}}},SUCCESS:function(e,t){return a({diffuse:{loading:!1,error:!1}},t)},PROGRESS:function(e,t){return a({},t)},FAIL:function(e,t){return a({diffuse:{loading:!1,error:!0}},t)}},asyncActionsDict:{},middleware:o,initialize:function(e){return{name:e,initialState:a({},u.initialState),reducer:u.reducer,middleware:o,asyncReducer:u.asyncReducer,actions:u.actionsDict,asyncActions:u.asyncActionsDict}},reducer:function(e,t){if(t.type in u.actionsDict)return a({},e,u.actionsDict[t.type](e,t.payload))},asyncReducer:function(e,t,n,r,c){try{return c(),Promise.resolve(u.asyncActionsDict[e.type]({state:e.store,payload:e.payload},t,n,r)).then((function(t){return a({},t,{type:e.type})}))}catch(i){return Promise.reject(i)}},addAction:function(e,t){"action"===t.type?u.actionsDict[e]=t.job:"async"===t.type&&(u.asyncActionsDict[e]=t.job)},removeAction:function(e){e in u.actionsDict&&delete u.actionsDict[e]},getActions:function(){var e=[];for(var t in u.actionsDict)e.push(u.actionsDict[t]);return e}};for(var s in c)u.addAction(s,c[s]);return u},m=function(e){for(var t=e.reducers,n=e.children,r=function(e){void 0===e&&(e=[]);var t=e.map((function(e){var t;return(t={})[e.name]=function(){return d({reducer:e.reducer,initialState:e.initialState,middleware:e.middleware,asyncReducer:e.asyncReducer,actions:e.actions,asyncActions:e.asyncActions})},t}));return t.map((function(e){Object.keys(e).map((function(e){}))})),t}(t),i={},o=0;o<r.length;o++){var a=Object.keys(r[o])[0];i[a]=r[o][a]()}return c.a.createElement(u.Provider,{value:i},n)},v=function(e){return function(t){console.log(e,t.type,t.store)}},y=l({initialState:{item:0},actions:{INCREMENT:{type:"action",job:function(e,t){return console.log(t),{item:e.item+1}}},DECREMENT:{type:"action",job:function(e){return{item:e.item-1}}}},middleware:{afterWare:[v("after")],beforeWare:[v("before")]}}),b=n(7),p=n(18),j=n(19),h=n.n(j),O=l({initialState:{item:0},actions:{INCREMENT:{type:"action",job:function(e,t){return{item:e.item+1}}},DECREMENT:{type:"action",job:function(e){return{item:e.item-1}}},GET_COUNT:{type:"async",job:function(){var e=Object(p.a)(Object(b.a)().mark((function e(t,n,r,c){var i,o;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.state,o=t.payload,e.prev=1,console.log(o),e.next=5,h.a.get("https://diffusenew.free.beeceptor.com").then((function(e){return new Promise((function(t){setTimeout((function(){t(e)}),1e3)}))}));case 5:return e.sent,e.abrupt("return",n({item:i.item+1}));case 9:e.prev=9,e.t0=e.catch(1),r({error:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n,r,c){return e.apply(this,arguments)}}()}},middleware:{afterWare:[v("after")],beforeWare:[v("before")]}}),R=O,E=n(20),A="AReducer",C=n(1);function g(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}var x=function(e){var t=Object(r.useState)(0),n=Object(E.a)(t,2),c=n[0],i=n[1];return Object(C.jsxs)("div",{style:{backgroundColor:"".concat(g())},onClick:function(e){e.stopPropagation(),e.preventDefault(),i(c+1)},children:["Text2: ",c," Rerender on click from Text"]})},S=f({fuseName:[A],Child:function(e){return Object(C.jsxs)("div",{style:{backgroundColor:"".concat(g())},onClick:function(){return e.AReducer.dispatch({type:"INCREMENT"})},children:["Text: ",e.AReducer.store.item," Times clicked! Color changes on click from Text",Object(C.jsx)(x,{})]})}});function N(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}var k=f({fuseName:["BReducer",A],Child:function(e){var t=e.BReducer;return Object(C.jsxs)("div",{style:{backgroundColor:"".concat(N())},onClick:function(){return t.actions.INCREMENT({test:"PAYLOAD"})},children:["Number: ",e.BReducer.store.item," Times clicked! Color changes on click from Number or Text"]})}});function D(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}var T=f({fuseName:["AsyncReducer"],Child:function(e){var t=e.AsyncReducer;return Object(C.jsxs)("div",{style:{backgroundColor:"".concat(D())},onClick:function(){t.actions.GET_COUNT({test:"SomeText"})},children:["NumberAsync:"," ",e.AsyncReducer.store.diffuse.loading?"loading":e.AsyncReducer.store.item," ","Times clicked! Color changes on click from Number or Text"]})}}),w=(n(51),function(e){var t=y.initialize("AReducer");console.log(t);var n=[y.initialize("AReducer"),y.initialize("BReducer"),R.initialize("AsyncReducer")];return Object(C.jsx)(m,{reducers:n,children:Object(C.jsxs)("div",{className:"App",children:[Object(C.jsx)("h1",{children:"DIFFUSE"}),Object(C.jsx)("h2",{children:"Global state management solution"}),Object(C.jsx)("h4",{children:"Color change = Rerender"}),Object(C.jsx)(k,{}),Object(C.jsx)(S,{}),Object(C.jsx)(T,{})]})})});o.a.render(Object(C.jsx)(w,{}),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.88f1a457.chunk.js.map